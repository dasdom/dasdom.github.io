I"<blockquote>
  <p>I’m writing <a href="https://leanpub.com/tddfakebookforios">a book about Test-Driven iOS Development</a> with Swift. It’s not a traditional book, it’s mainly only the code. If you are like me and seldom read blog posts but rather skim for the code, this book is for you.</p>
</blockquote>

<p>Let’s say we need to test if an action triggers the presentation of a view controller. The test looks like this:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">test_presentationOfViewController</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Arrange</span>
  <span class="k">let</span> <span class="nv">window</span> <span class="o">=</span> <span class="kt">UIWindow</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">width</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">300</span><span class="p">))</span>
  <span class="c1">// sut == system under test</span>
  <span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="n">sut</span>
  <span class="n">window</span><span class="o">.</span><span class="nf">makeKeyAndVisible</span><span class="p">()</span>
    
  <span class="c1">// Act</span>
  <span class="n">sut</span><span class="o">.</span><span class="nf">showNext</span><span class="p">()</span>
    
  <span class="c1">// Assert</span>
  <span class="kt">XCTAssertTrue</span><span class="p">(</span><span class="n">sut</span><span class="o">.</span><span class="n">presentedViewController</span> <span class="k">is</span> <span class="kt">DetailViewController</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>First we have to set the view controller (<code class="highlighter-rouge">sut</code>) that presents the other view controller as the <code class="highlighter-rouge">rootViewController</code> of a window. Then we need to make the window the key window. This way, the view of the view controller is added to the view hierarchy. If we miss the step, no other view controller can be presented on top of that view controller.</p>

<p>Next the presentation is triggered. How this is done, depends on the code under test. For simplicity, I assume that there is a method <code class="highlighter-rouge">showNext()</code> that triggers the presentation.</p>

<p>In the end we assert that the presented view controller has the expected type. Depending on the presented view controller, we could also assert that an expected item (user, point of interest, tweet, etc) has been passed to it.</p>

<p>That’s all. Straight forward. The tricky part is to remember to add the view controller under test as the root view controller to a window and make the window the key window.</p>

<p>Follow me on <a href="https://www.twitter.com/dasdom">Twitter</a>.</p>
:ET