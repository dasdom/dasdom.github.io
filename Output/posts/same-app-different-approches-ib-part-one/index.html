<!DOCTYPE html><html><head><meta charset="UTF-8"/><meta name="og:site_name" content="dasdom"/><link rel="canonical" href="https://dasdom.dev/posts/same-app-different-approches-ib-part-one"/><meta name="twitter:url" content="https://dasdom.dev/posts/same-app-different-approches-ib-part-one"/><meta name="og:url" content="https://dasdom.dev/posts/same-app-different-approches-ib-part-one"/><title>One App, Different Approaches: Interface Builder (Part One) | dasdom</title><meta name="twitter:title" content="One App, Different Approaches: Interface Builder (Part One) | dasdom"/><meta name="og:title" content="One App, Different Approaches: Interface Builder (Part One) | dasdom"/><meta name="description" content="Swift, iOS, ObjC and stuff"/><meta name="twitter:description" content="Swift, iOS, ObjC and stuff"/><meta name="og:description" content="Swift, iOS, ObjC and stuff"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to dasdom"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">dasdom</a><nav><ul><li><a class="selected" href="/posts">Posts</a></li><li><a href="/books">Books</a></li><li><a href="/about">About</a></li><li><a href="/imprint">Imprint</a></li><li><a href="/privacy">Privacy</a></li></ul></nav></div></header><div class="wrapper"><p>25. Aug 2020</p><article><div class="content"><h1>One App, Different Approaches: Interface Builder (Part One)</h1><p>As an iOS developer you need to be able to build the user interface of your apps using different approaches. Without using a third party library you can mainly choose between Storyboards, using code to build the user interface, and SwiftUI. Each of these has it's advantages and disadvantages and each developer has a preference.</p><p>I think beginners should learn about these different approaches right from the start. That's why I use all three in my book <a href="https://pragprog.com/book/dhios/build-location-based-projects-for-ios">Build Location-Bases Projects for iOS</a>. I'm quite proud of it and I think you should check it out.</p><img src="../../assets/2020-08-25/build_location_based_projects.jpg"/><p>In this and the next several blog posts I will show you how to build one app using these different approaches. The app we build is a birthday countdown app. You can add the birthdays of your loved ones and the app shows you the number of days until their next birthday. It will look like this:</p><img src="../../assets/2020-08-25/the_app.png"/><p>(From the number you can reconstruct when I wrote the blog post. ;))</p><p>In this post we will use a Storyboard for the user interface.</p><blockquote><p>Note: We will put all the screens in one Storyboard because it's a small and simple app. In a real app, you might want to split the user interface into several Storyboards. Let me know when you like to see a post about that in the future.</p></blockquote><p>We want to concentrate on the differences in building the user interface. Adding and storing the birthday data would distract from the main topic. We will use a Swift package that I wrote for this blog mini series to hide how this works.</p><h2>Creating The Xcode Project</h2><p>Open Xcode and create a new project using the shortcut ⌘⇧N. Choose the Single View App template and click Next. Type in the name BirthdaysIB, select the language Swift, select Storyboard for the User Interface and deselect the check boxes for Core Data, Include Unit Tests and Include UI Tests. We won't write tests in this demo app and storing the data is manages by the Swift package we will include.</p><img src="../../assets/2020-08-25/project_options.png"/><p>Click Next, choose a location on your disk to store the project and click Create.</p><p>Next we add the package that will manage the birthday data.</p><h2>Adding The Swift Package</h2><p>Select the Xcode menu item <code>File &gt; Swift Packages &gt; Add Package Dependency</code> and paste the package URL <code>https://github.com/dasdom/Birthdays</code> into the search field. Click Next, click Next again and click Finish. Xcode adds the package to the project. Subsequently the project navigator should look like this:</p><img src="../../assets/2020-08-25/project_navigator_after_adding_the_package.png"/><h2>Creating The Birthday Countdown View</h2><p>Now let's create the user interface that shows the remaining days until the next birthdays. Click <code>Main.storyboard</code> to open it in the Interface Builder, show the library using the shortcut ⌘⇧L and drag a <code>UITableViewController</code> into the Storyboard. Open the attributes inspector with the shortcut ⌥⌘5 and check the check box next to Is Initial View Controller. Delete the View Controller Scene from the Storyboard.</p><blockquote><p>Note: With all the enhancements in <code>UICollectionView</code> in iOS 13 and iOS 14 the user interface could easily be implemented using a collection view with compositional layout. In fact we will do that in the chapter in which we build this app without a storyboard. In this chapter we will use a <code>UITableView</code> because in a storyboard we can only use a collection view flow layout.</p></blockquote><p>Open the library again and drag two labels into the table view cell of the table view. Select both labels by clicking one of them and pressing the ⌘ key while you click the other one. Then click the Embed button (the one with the arrow pointing into a box) in the lower right corner of the interface builder. In the pop up window select Stack View:</p><img src="../../assets/2020-09-25/embed_label_into_stackview.png"/><p>Stack views are a very powerful tool to easily create complex layouts. They layout their arranged views vertically or horizontally and you only have to configure a few variables. See for example <a href="../uistackviewplayground/">UIStackViewPlayground</a>.</p><p>With the created stack view selected, open the attributes inspector using the shortcut ⌥⌘5. Look for the setting with the name Spacing. This value defines the spacing between the arranged sub views of the stack view. Type in the value <code>10</code> and press return. The Interface Builder reduces the size of the stack view such that it just large enough to embed its sub views respecting the set spacing.</p><p>Next we need to add layout constraints to define the position of the stack view within the table view cell. Select the stack view and click the Add New Constraint button (the one with the square between the vertical lines) in the lower right of the Interface Builder. Xcode opens a pop up window in which we can define the constraints we want to add. Type in <code>0</code> into the four text fields in the upper third of the pop up and make sure the red markers are selected like shown in the following image:</p><img src="../../assets/2020-08-25/stackview_constraints_in_cell.png"/><p>Click Add 4 Constraints. After adding the constraints, Interface Builder shows a red circle with a black arrow in the structure overview of the storyboard to indicate that there is a problem with the added layout constraints.</p><img src="../../assets/2020-08-25/layout_error_in_cell.png"/><p>Click the button to figure out, what the problem is. The shown information is a bit confusing so let me explain what the problem is. We haven't told the stack view exactly how it should layout its sub views. We just told it that the spacing should be exactly 10 points. But what should be the width of the labels? And which of the labels should shrink if there is not enough space to show both?</p><p>We have to tell the stack view, or more precisely the layout system what to do. The easiest way to solve this problem is to tell the layout system that the label on the right should pull its edges inward. Select the right button, open the size inspector (⌥⌘6) and set the horizontal hugging priority to 252 as show in the following image:</p><img src="../../assets/2020-08-25/hugging_priority_days_lable.png"/><p>Subsequently the error indicator in the structure overview is gone. Let's make the user interface a little bit more pleasing. Select the left label, open the attributes inspector and change the font style to bold.</p><h2>Embedding in a Navigation Controller</h2><p>The user should see what this app is about. Let's embed the view controller into a navigation controller to add a navigation bar to put the title in. This has the great advantage that we can put the button to add birthdays to the list there as well.</p><p>In the Interface Builder select the table view controller and click the Xcode menu item <em>Editor / Embed In / Navigation Controller</em>. Next select the navigation bar of the added navigation controller and open the attribute inspector (⌥⌘5). Check the check box at Prefers Large Titles. Then click the navigation bar in the table view controller and type in the title "Birthdays".</p><p>Next we are going to add the source code for the birthday countdown list.</p><h2>BithdayCountdownViewController</h2><p>First remove the file <em>ViewController.swift</em>. Next use the shortcut ⌘N to add a new Cocoa Touch Class. Type in the name <code>BirthdaysCountdownViewController</code> and make it the subclass of <code>UITableViewController</code>. Make sure the check box at Also create XIB file is not selected and the language is set to Swift. Click Next and the click Create.</p><p>The birthdays are managed by our Birthdays package so we need to import it into this file. The package uses Combine to publish changes to the list of birthdays. Add the following import statements to <code>BirthdaysCountdownViewController</code> below the existing import statement:</p><pre><code><span class="keyword">import</span> Birthdays
<span class="keyword">import</span> Combine
</code></pre><p>Next add the following property of a <code>BirthdaysManager</code> to <code>BirthdaysCountdownViewController</code>:</p><pre><code><span class="keyword">private let</span> birthdaysManager = <span class="type">BirthdaysManager</span>()
</code></pre><p>You don't need to understand how the <code>BirthdaysManager</code> works for this blog series. You only need to know that you can add birthdays and subscribe to changes via Combine.</p><p>To be notified when something in the list of birthday countdowns changes, we need to subscribe to the corresponding Combine publisher. Add the following property to <code>BirthdaysCountdownViewController</code>:</p><pre><code><span class="keyword">private var</span> subscription: <span class="type">AnyCancellable</span>?
</code></pre><p>We also need a property to hold the birthdayCountdowns to be shown in the table view. Add the following property for and array of <code>BirthdayCountdown</code>s:</p><pre><code><span class="keyword">private var</span> birthdayCountdowns: [<span class="type">BirthdayCountdown</span>] = [] {
  <span class="keyword">didSet</span> {
    <span class="keyword">self</span>.<span class="property">tableView</span>.<span class="call">reloadData</span>()
  }
}
</code></pre><p>When ever the array with the birthday countdowns changes, we just reload the table view. Usually you wouldn't reload the whole table view when only one of the entries changes but for the moment this is OK because adding new birthdays countdowns will we handled in another view.</p><p>To subscribe to changes add the following code at the end of <code>viewDidLoad()</code>:</p><pre><code>subscription = birthdaysManager.$birthdayCounts
  .<span class="call">sink</span>(receiveValue: { birthdayCounts <span class="keyword">in
    self</span>.<span class="property">birthdayCountdowns</span> = birthdayCounts
  })
</code></pre><p>With this code we subscribe to changes in the birthday counts array in the <code>Birthdays</code> package.</p><p>In the storyboard we added some label to the table view cell. We also need a class for that table view cell to be able to connect the code of the cell with the cell in the storyboard. Add a new Cocoa Touch Class to the project using the shortcut ⌘N, type in the name BirthdayCountdownCell and make it a subclass of <code>UITableViewCell</code>. Remove the code in the created class.</p><p>Next we need to connect the storyboard with the code. Open <code>Main.storyboard</code>, select the table view controller and open the identity inspector (⌥⌘4). In the text field next to Class type in the name <code>BirthdaysCountdownViewController</code> and press return.</p><p>Then select the table view cell and set the class in the identity inspector to <code>BirthdayCountdownCell</code> and press return. Open the attributes inspector with the shortcut ⌥⌘5 and type in the Identifier <code>BirthdayCountdownCell</code> and press return.</p><blockquote><p>Note: I always use the class name as the identifier of the table view cell. That way I have less to remember when returning back to the code.</p></blockquote><p>In the storyboard click the table view cell until it is colored and open the assistant editor with the shortcut ⌃⌥⌘⏎. Next select <em>BirthdayCountdownCell.swift</em> in the header bar of the editor:</p><img src="../../assets/2020-08-25/cell_in_editor_header_bar.png"/><p>Press and hold the control key and drag from the left label into the <code>BirthdayCountdownCell</code> class. In the appearing pop-up window, type in the name <code>nameLabel</code> and make sure that Connection is set to Outlet:</p><img src="../../assets/2020-08-25/name_label_outlet_config.png"/><p>In the same way create an outlet for the right label with the name <code>countLabel</code>.</p><p>The cell shows the name of the person and the number of days until their next birthday. Import the Birthdays module and add the following method that we will call from the table view controller to setup the cell with the data:</p><pre><code><span class="keyword">import</span> UIKit
<span class="keyword">import</span> Birthdays

<span class="keyword">class</span> BirthdayCountdownCell: <span class="type">UITableViewCell</span> {

  <span class="keyword">@IBOutlet var</span> nameLabel: <span class="type">UILabel</span>!
  <span class="keyword">@IBOutlet var</span> countLabel: <span class="type">UILabel</span>!
  
  <span class="keyword">func</span> update(with birthdayCount: <span class="type">BirthdayCountdown</span>) {
    nameLabel.<span class="property">text</span> = birthdayCount.<span class="property">name</span>
    countLabel.<span class="property">text</span> = <span class="string">"</span>\(birthdayCount.<span class="property">remainingDays</span>)<span class="string">"</span>
  }
}
</code></pre><p>Next open <em>BirthdaysCountdownViewController.swift</em>, delete the method <code>numberOfSections(in:)</code> and replace the methods <code>tableView(_:numberOfRowsInSection:)</code> with the following code:</p><pre><code><span class="keyword">override func</span> tableView(<span class="keyword">_</span> tableView: <span class="type">UITableView</span>, numberOfRowsInSection section: <span class="type">Int</span>) -&gt; <span class="type">Int</span> {
  <span class="keyword">return</span> birthdayCountdowns.<span class="property">count</span>
}
</code></pre><p>With this code we tell the table view that it contains <code>birthdayCountdowns.count</code> cells. Next, we have to tell the table view which cell it should use. Add the following method to <code>BirthdaysCountdownViewController</code>:</p><pre><code><span class="keyword">override func</span> tableView(<span class="keyword">_</span> tableView: <span class="type">UITableView</span>, cellForRowAt indexPath: <span class="type">IndexPath</span>) -&gt; <span class="type">UITableViewCell</span> {
  
  <span class="keyword">let</span> cell = tableView.<span class="call">dequeueReusableCell</span>(withIdentifier: <span class="string">"BirthdayCell"</span>, for: indexPath) <span class="keyword">as</span>! <span class="type">BirthdayCell</span>
  
  <span class="keyword">let</span> birthday = birthdayCounts[indexPath.<span class="property">row</span>]
  cell.<span class="call">update</span>(with: birthday)
  
  <span class="keyword">return</span> cell
}
</code></pre></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/storyboard">Storyboard</a></li><li><a href="/tags/uitableview">UITableView</a></li></ul></article></div><footer><p><a href="https://www.buymeacoffee.com/dasdom">Buy me a coffee</a></p><p><a href="/feed.rss">RSS feed</a><a> | </a><a href="https://twitter.com/dasdom">Twitter</a><a> | </a><a href="https://stackoverflow.com/users/498796/dasdom">StackOverflow</a><a> | </a><a href="https://github.com/dasdom">Github</a><a> | </a><a href="https://pragprog.com/titles/dhios/">My Book</a></p><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p></footer></body></html>