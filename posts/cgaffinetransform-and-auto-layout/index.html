<!DOCTYPE html><html><head><meta charset="UTF-8"/><meta name="og:site_name" content="dasdom"/><link rel="canonical" href="https://dasdom.dev/posts/cgaffinetransform-and-auto-layout"/><meta name="twitter:url" content="https://dasdom.dev/posts/cgaffinetransform-and-auto-layout"/><meta name="og:url" content="https://dasdom.dev/posts/cgaffinetransform-and-auto-layout"/><title>CGAffineTransform and Auto Layout | dasdom</title><meta name="twitter:title" content="CGAffineTransform and Auto Layout | dasdom"/><meta name="og:title" content="CGAffineTransform and Auto Layout | dasdom"/><meta name="description" content="Be careful when using CGAffineTransform with Auto Layout."/><meta name="twitter:description" content="Be careful when using CGAffineTransform with Auto Layout."/><meta name="og:description" content="Be careful when using CGAffineTransform with Auto Layout."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to dasdom"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">dasdom</a><nav><ul><li><a class="selected" href="/posts">Posts</a></li><li><a href="/books">Books</a></li><li><a href="/about">About</a></li><li><a href="/imprint">Imprint</a></li><li><a href="/privacy">Privacy</a></li></ul></nav></div></header><div class="wrapper"><p>11. Apr 2020</p><article><div class="content"><h1>CGAffineTransform and Auto Layout</h1><p>This week at work I had a strange bug in an iOS app. It looked like something was wrong with the Auto Layout constraints. The following screenshot shows a simplified version of the user interface.</p><img src="../../assets/2020-04-11/user_interface_with_wrong_spacing.png"/><p>In the storyboard the distance between the image and the label was defined as 10 points as you can see in the following screenshot:</p><img src="../../assets/2020-04-11/space_constraint_in_interface_builder.png"/><p>But when running the app on the simulator or on a real device the space between the image and the label was much larger than 10 points. To figure out the real distance, I set the window of the simulator to Point Accurate.</p><img src="../../assets/2020-04-11/point_accurate_setting.png"/><p>With this setting the number of pixels on the Mac display correspond to the points in the user interface. To count the number of pixels, we can scale the Mac display using the zoom accessibility feature or we can use 3rd-party tool. A great tool for such a task is <a href="https://xscopeapp.com">xScope</a>. Using xScope, I measure a distance of 29 points.</p><img src="../../assets/2020-04-11/real_distance_measured.png"/><p>The real user interface was more complex than that. The image view was a custom <code>UIView</code> subclass defined in a Xib, containing several instances of <code>UIImageView</code>. Because of that complexity and a few other problems in the storyboard, it took me about an hour to finally get the idea to look into the code of the host view. And there I found a line like this:</p><pre><code>imageView.<span class="property">transform</span> = <span class="type">CGAffineTransform</span>(scaleX: <span class="number">0.8</span>, y: <span class="number">0.8</span>)
</code></pre><p>The previous developer working on that code used an <code>CGAffineTransform</code> instead of layout constraints to make the image view smaller. I guess the reason for this decision was, that in the Xib of the composed view, one of the image views had a fixed width. And because of time constraints, using a transform might be the faster solution to his problem.</p><p>To solve the layout problem, I added size constraints to the image view and fixed the constraints in the Xib.</p><p>As a side note, I learned during the investigation that an affine transform on a view changes the frame but not the bounds:</p><img src="../../assets/2020-04-11/bounds_not_transformed.png"/><p>That might be common sense and completely obvious to you, but is was new to me. :)</p><p>If you have any comments on that post, you can find my on Twitter as <a href="https://twitter.com/dasdom">@dasdom</a>.</p></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/cgaffinetransform">CGAffineTransform</a></li><li><a href="/tags/auto-layout">Auto Layout</a></li></ul></article></div><footer><p><a href="https://www.buymeacoffee.com/dasdom">Buy me a coffee</a></p><p><a href="/feed.rss">RSS feed</a><a> | </a><a href="https://twitter.com/dasdom">Twitter</a><a> | </a><a href="https://stackoverflow.com/users/498796/dasdom">StackOverflow</a><a> | </a><a href="https://github.com/dasdom">Github</a><a> | </a><a href="https://pragprog.com/titles/dhios/">My Book</a></p><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p></footer></body></html>