---
layout: post
title: 'How To Build An App Without Interface Builder â€“ Part 7: Nicer Cell'
date: 2015-09-08 22:31:39.000000000 +02:00
type: post
published: true
status: publish
categories:
- Allgemein
tags:
- Interface Builder
- Swift
- UI
- UITableViewCell
---
<p>Now let's make the table view cell nicer. First we need a patter image. I used Paintcode to generate this patter:</p>
<p><a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/09/cellBackgroundPattern@3x.png"><img src="{{ site.baseurl }}/assets/cellBackgroundPattern@3x.png" alt="cellBackgroundPattern@3x" width="60" height="150" class="aligncenter size-full wp-image-942" /></a></p>
<p>You can download the pattern images <a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/09/pattern.zip">here</a>. Put the three images into the assed catalog of the app. Now open <strong>BirthdayCell.swift</strong> and add the following property:</p>
<pre class="lang:swift decode:true ">let patternView: UIView</pre>
<p>In the initializer before the <span class="lang:swift decode:true  crayon-inline ">super.init</span> call add the code:</p>
<pre class="lang:swift decode:true ">patternView = UIView()
patternView.translatesAutoresizingMaskIntoConstraints = false</pre>
<p>This is needed because non optional properties need to be initialized when <span class="lang:swift decode:true  crayon-inline ">super.init</span> is called.</p>
<p>Now set the patter as the background color of the patter view and add the it to the cell by adding the following code after the <span class="lang:swift decode:true  crayon-inline ">super.init</span> call:</p>
<pre class="lang:swift decode:true ">patternView.backgroundColor = UIColor(patternImage: UIImage(named: "cellBackgroundPattern")!)

addSubview(patternView)
</pre>
<!--more-->
<p>The pattern view needs some constraints. First we need to change the <span class="lang:swift decode:true  crayon-inline ">views</span> to this:</p>
<pre class="lang:swift decode:true ">let views = ["pattern": patternView, "name": nameLabel, "birthday": birthdayLabel]
</pre>
<p>Put the following code at the beginning of the constrains definition:</p>
<pre class="lang:swift decode:true ">layoutConstraints += NSLayoutConstraint.constraintsWithVisualFormat("|[pattern]", options: [], metrics: nil, views: views)
layoutConstraints += NSLayoutConstraint.constraintsWithVisualFormat("V:|[pattern]|", options: [], metrics: nil, views: views)
layoutConstraints.append(patternView.trailingAnchor.constraintEqualToAnchor(trailingAnchor, constant: -80))</pre>
<p>Build and run and add John Appleseed to the list. You should see something like this:</p>
<p><a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/09/Simulator-Screen-Shot-06.09.2015-22.30.38.png"><img src="{{ site.baseurl }}/assets/Simulator-Screen-Shot-06.09.2015-22.30.38-200x300.png" alt="Simulator Screen Shot 06.09.2015 22.30.38" width="200" height="300" class="aligncenter size-medium wp-image-949" /></a></p>
<p>Hm, ok. The name isn't readable anymore. Add the following code to the setup of the name label:</p>
<pre class="lang:swift decode:true ">nameLabel.font = .systemFontOfSize(30)
nameLabel.textColor = .whiteColor()</pre>
<p>Build and run again. Now it looks much better. But what if the progress has a value that the pattern is partly beneath the name and partly not. First let's figure out how big the problem is. Set the trailing constraint for the pattern view to -150:</p>
<pre class="lang:swift decode:true ">layoutConstraints.append(patternView.trailingAnchor.constraintEqualToAnchor(trailingAnchor, constant: -150))
</pre>
<p>Build and run. You should see something like this:</p>
<p><a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/09/Simulator-Screen-Shot-07.09.2015-19.11.42.png"><img src="{{ site.baseurl }}/assets/Simulator-Screen-Shot-07.09.2015-19.11.42-200x300.png" alt="Simulator Screen Shot 07.09.2015 19.11.42" width="200" height="300" class="aligncenter size-medium wp-image-952" /></a></p>
<p>Uh, thats bad. The name isn't readable because it's white text on a white background. We are going to change that.</p>
<p>First remove the line <span class="lang:swift decode:true  crayon-inline ">nameLabel.textColor = .whiteColor()</span>. Then rearrange the addSubview calls that the order is like that:</p>
<pre class="lang:swift decode:true ">addSubview(nameLabel)
addSubview(birthdayLabel)
addSubview(patternView)</pre>
<p>With this change the patter background is above the name label. Build and run and add John to the list. You should see something like this:</p>
<p><a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/09/Simulator-Screen-Shot-08.09.2015-22.20.05.png"><img src="{{ site.baseurl }}/assets/Simulator-Screen-Shot-08.09.2015-22.20.05-200x300.png" alt="Simulator Screen Shot 08.09.2015 22.20.05" width="200" height="300" class="aligncenter size-medium wp-image-955" /></a></p>
<p>Now add another label property:</p>
<pre class="lang:swift decode:true ">let patternNameLabel: UILabel
</pre>
<p>Add within the initializer:</p>
<pre class="lang:swift decode:true ">patternNameLabel = UILabel()
patternNameLabel.translatesAutoresizingMaskIntoConstraints = false
patternNameLabel.font = nameLabel.font
patternNameLabel.textColor = .whiteColor()</pre>
<p>Now add the label as a subview to the pattern view:</p>
<pre class="lang:swift decode:true ">patternView.addSubview(patternNameLabel)</pre>
<p>We need constraints for the new label. The constraints need to be in a way that the new label is at exact same position as the name label. Add these constraints:</p>
<pre class="lang:swift decode:true ">layoutConstraints.append(patternNameLabel.leadingAnchor.constraintEqualToAnchor(nameLabel.leadingAnchor))
layoutConstraints.append(patternNameLabel.centerYAnchor.constraintEqualToAnchor(nameLabel.centerYAnchor))</pre>
<p>These have been a lot changes. For completeness here is the table view cell class how it looks like after the changes:</p>
<pre class="lang:swift decode:true ">import UIKit

class BirthdayCell: UITableViewCell {

  let patternView: UIView
  let nameLabel: UILabel
  let patternNameLabel: UILabel
  let birthdayLabel: UILabel
  
  override init(style: UITableViewCellStyle, reuseIdentifier: String?) {
    
    patternView = UIView()
    patternView.translatesAutoresizingMaskIntoConstraints = false
    patternView.clipsToBounds = true
    
    nameLabel = UILabel()
    nameLabel.translatesAutoresizingMaskIntoConstraints = false
    nameLabel.font = .systemFontOfSize(30)
    
    patternNameLabel = UILabel()
    patternNameLabel.translatesAutoresizingMaskIntoConstraints = false
    patternNameLabel.font = nameLabel.font
    patternNameLabel.textColor = .whiteColor()
    
    birthdayLabel = UILabel()
    birthdayLabel.translatesAutoresizingMaskIntoConstraints = false
    
    super.init(style: style, reuseIdentifier: reuseIdentifier)
    
    patternView.backgroundColor = UIColor(patternImage: UIImage(named: "cellBackgroundPattern")!)
    
    addSubview(nameLabel)
    addSubview(birthdayLabel)
    addSubview(patternView)
    patternView.addSubview(patternNameLabel)
    
    let views = ["pattern": patternView, "name": nameLabel, "birthday": birthdayLabel]
    var layoutConstraints = [NSLayoutConstraint]()
    
    layoutConstraints += NSLayoutConstraint.constraintsWithVisualFormat("|[pattern]", options: [], metrics: nil, views: views)
    layoutConstraints += NSLayoutConstraint.constraintsWithVisualFormat("V:|[pattern]|", options: [], metrics: nil, views: views)
    layoutConstraints.append(patternView.trailingAnchor.constraintEqualToAnchor(trailingAnchor, constant: -150))
    layoutConstraints.append(nameLabel.centerXAnchor.constraintEqualToAnchor(centerXAnchor))
    layoutConstraints.append(nameLabel.centerYAnchor.constraintEqualToAnchor(centerYAnchor))
    layoutConstraints += NSLayoutConstraint.constraintsWithVisualFormat("[birthday]-|", options: [], metrics: nil, views: views)
    layoutConstraints += NSLayoutConstraint.constraintsWithVisualFormat("V:[birthday]|", options: [], metrics: nil, views: views)
    
    layoutConstraints.append(patternNameLabel.leadingAnchor.constraintEqualToAnchor(nameLabel.leadingAnchor))
    layoutConstraints.append(patternNameLabel.centerYAnchor.constraintEqualToAnchor(nameLabel.centerYAnchor))
    
    NSLayoutConstraint.activateConstraints(layoutConstraints)
  }

  required init?(coder aDecoder: NSCoder) {
      fatalError("init(coder:) has not been implemented")
  }
}
</pre>
<p>The last thing we need to do is to set the name to the patter name label. Open <strong>BirthdaysListDataProvider.swift</strong> and add the following line in <span class="lang:swift decode:true  crayon-inline ">cellForRowAtIndexPath</span>:</p>
<pre class="lang:swift decode:true ">cell.patternNameLabel.text = birthday.firstName</pre>
<p>Now let's see the result. Build and run and add John. You should see something like this:<br />
<a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/09/Simulator-Screen-Shot-08.09.2015-22.28.40.png"><img src="{{ site.baseurl }}/assets/Simulator-Screen-Shot-08.09.2015-22.28.40-200x300.png" alt="Simulator Screen Shot 08.09.2015 22.28.40" width="200" height="300" class="aligncenter size-medium wp-image-956" /></a></p>
<p>Nice. This is a much nicer cell. It's not perfect yet. But this is enough for today. See you next time.</p>
<p>You can find the code on <a href="https://github.com/dasdom/Birthdays">github</a>.</p>
