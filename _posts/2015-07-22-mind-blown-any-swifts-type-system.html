---
layout: post
title: Mind-Blown By Swift's Type System
date: 2015-07-22 14:06:50.000000000 +02:00
type: post
published: true
status: publish
categories:
- Tips
tags:
- Less Code
- Swift
- Type System
- UIColor
meta:
  robotsmeta: index,follow
  _edit_last: '1'
  _wpcom_is_markdown: '1'
author:
  login: dom
  email: dominik.hauser@dasdom.de
  display_name: dom
  first_name: ''
  last_name: ''
---
<p>Swift's type system is a source of frustration and not few developer state that it solves a problem nobody had. In my opinion it's useful mainly for beginners. It helps to find misunderstandings of Cocoa APIs and other people's code early. But I also think that the influence on the number of bad bugs in shipped apps is low. Most of the prevented errors are so obvious that they get caught during debug runs.</p>
<p>But a few days ago I stubbled across a feature of Swift's type system that blew my mind.</p>
<p>You sure have seen already this kind of type inference:</p>
<pre class="lang:swift decode:true ">func aNumber() -&gt; Int { return 1 }
func aNumber() -&gt; Double { return 2.0 }

let a: Int = aNumber() // -&gt; 1
let b: Double = aNumber() // -&gt; 2</pre>
<p>The constant  <span class="lang:swift decode:true  crayon-inline ">a</span> is declared to be of type <span class="lang:swift decode:true  crayon-inline ">Int</span> and therefore the first version of <span class="lang:swift decode:true  crayon-inline ">aNumber()</span> is called. In the case of a <span class="lang:swift decode:true  crayon-inline ">Double</span> on the left side of the assignment (<span class="lang:swift decode:true  crayon-inline ">b</span>) the second version is called.</p>
<p>So far so good. Let's take this to the next level. <span class="lang:swift decode:true  crayon-inline ">UIView</span> has an initializer that takes a <span class="lang:swift decode:true  crayon-inline ">CGRect</span>. This makes the following type inference possible:</p>
<pre class="lang:swift decode:true ">var coloredView = UIView(frame: .zeroRect)</pre>
<p>So the compiler already knows that the frame only can be a <span class="lang:swift decode:true  crayon-inline ">CGRect</span>  and accesses the corresponding property <span class="lang:swift decode:true  crayon-inline ">zeroRect</span> of <span class="lang:swift decode:true  crayon-inline ">CGRect</span>.</p>
<p>This is already kind of cool. But there is more. The type system can handle code like this:</p>
<pre class="lang:swift decode:true ">coloredView.backgroundColor = .yellowColor()</pre>
<p>And this blew my mind. It make the code easier to read an removes unnecessary cruft. But it's also kind of obvious because it's kind of the same as the previous example in the initializer of <span class="lang:swift decode:true  crayon-inline ">UIView</span>.</p>
<p>And then I became high-spirited and tried this:</p>
<pre class="lang:swift decode:true ">var layoutConstraints = [NSLayoutConstraint]()
layoutConstraints += .constraintsWithVisualFormat("|-[stackView]-|", options: [], metrics: nil, views: views)</pre>
<p>(Note that <span class="lang:swift decode:true  crayon-inline ">NSLayoutConstraint</span> is missing in front of <span class="lang:swift decode:true  crayon-inline ">constraintsWithVisualFormat(...)</span>.)</p>
<p>Unfortunately it doesn't work. To find out what the problem is I changed the code to:</p>
<pre class="lang:swift decode:true ">let theConstraints: [NSLayoutConstraint] = .constraintsWithVisualFormat("|-[stackView]-|", options: [], metrics: nil, views: views)</pre>
<p>and got the error:</p>
<pre class="lang:sh decode:true ">'[NSLayoutConstraint].Type' does not have a member named 'constraintsWithVisualFormat'</pre>
<p>This means the compiler uses the type on the left side to find a method with the signature from the right side of the assignment. This obviously doesn't work and I'm not sure if it should work. It would make my code more compact but at some point more compact becomes to compact.</p>
<p>If you enjoyed this post, then make sure you subscribe to my <a href="http://swiftandpainless.com/feed">feed</a>.</p>
