---
layout: post
title: 'How To Build An App Without Interface Builder - Part 5: Data Model'
date: 2015-08-24 19:39:34.000000000 +02:00
type: post
published: true
status: publish
categories:
- HowTo
tags:
- Bar Button
- Contacts
- Data Model
- UINavigationController
---
<p>In <a href="http://swiftandpainless.com/how-to-build-an-app-without-interface-builder-part-4-datasource/">part 4</a> of this series we have implemented the bare bones of the view controller and the data source for the table view. Before we can flesh out those classes, we need a data model to store the data in.</p>
<p>Let's use a struct for the data model because this is the way to go in Swift. Go to <strong>File / New / File...</strong> and select an <strong>iOS / Source / Swift File</strong>. Put in the name <strong>Birthday</strong> create a new folder called <strong>Model</strong> and click two times <strong>Create</strong>. You end up with an empty swift file. Ok, it's not completely empty. There is a comment and it imports <strong>Foundation</strong>.</p>
<p>Put in the following struct definition:</p>
<pre class="lang:swift decode:true ">struct Birthday {
    let firstName: String
    let lastName: String
    let birthday: NSDateComponents
}</pre>
<p>For now this is the complete model implementation. We will later add archiving and unarchiving to this model. But for now it is enough to keep the code flowing. :)</p>
<p>The app should allow the addition of birthdays of friends and family the user have in their address book. So we need a button somewhere. It is very common in an app showing a table view to have buttons in a navigation bar. To add a navigation bar we will put the view controller into a navigation controller. This has the additional benefit that we can easily navigate to detail views later in the implementation.</p>
<!--more-->
<p>Open <strong>AppDelegate.swift</strong> and replace the line:</p>
<pre class="lang:swift decode:true ">window!.rootViewController = viewController
</pre>
<p>with this code:</p>
<pre class="lang:swift decode:true ">window!.rootViewController = UINavigationController(rootViewController: viewController)
</pre>
<p>This code adds a navigation controller to the app. Build and run the app to see how it looks like. You should see something like this:<br />
<a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/08/Simulator-Screen-Shot-23.08.2015-18.33.52.png"><img src="{{ site.baseurl }}/assets/Simulator-Screen-Shot-23.08.2015-18.33.52-200x300.png" alt="Simulator Screen Shot 23.08.2015 18.33.52" width="200" height="300" class="aligncenter size-medium wp-image-913" /></a></p>
<p>The color of the navigation bar comes from the color of the table view. Let's get rid of the color because it was only set for debugging. Open <strong>BirthdaysListViewController.swift</strong> and remove the line:</p>
<pre class="lang:swift decode:true ">view.backgroundColor = .redColor()
</pre>
<p>Build and run again. Now this looks much better. Not good, but better. :)</p>
<p>To add a bar button item, add the following code to  <span class="lang:swift decode:true  crayon-inline ">viewDidLoad()</span>:</p>
<pre class="lang:swift decode:true ">let addButton = UIBarButtonItem(barButtonSystemItem: .Add, target: self, action: "addPerson")
navigationItem.rightBarButtonItem = addButton
</pre>
<p>Build and run again. You should see a plus sign in the navigation bar like this:<br />
<a href="http://swift.eltanin.uberspace.de/wp-content/uploads/2015/08/Simulator-Screen-Shot-23.08.2015-18.41.17.png"><img src="{{ site.baseurl }}/assets/Simulator-Screen-Shot-23.08.2015-18.41.17-200x300.png" alt="Simulator Screen Shot 23.08.2015 18.41.17" width="200" height="300" class="aligncenter size-medium wp-image-914" /></a></p>
<p>When the user taps the button, a view controller should appear where she can select the friend whose birthday she wants to remember. Apple already provides such a view controller for us: <span class="lang:swift decode:true  crayon-inline ">CNContactPickerViewController</span>. And the good thing is, because this view controller is controlled by UIKit you don't need to ask the user for permission to access the address book.</p>
<p>To use it, import <strong>ContactsUI</strong>:</p>
<pre class="lang:swift decode:true ">import ContactsUI</pre>
<p>and add the following method to the <span class="lang:swift decode:true  crayon-inline ">BirthdaysListViewController</span> class:</p>
<pre class="lang:swift decode:true ">func addPerson() {
  let picker = CNContactPickerViewController()
  picker.delegate = self
  presentViewController(picker, animated: true, completion: nil)
}</pre>
<p>The compiler will complain because <span class="lang:swift decode:true  crayon-inline ">BirthdaysListViewController</span> doesn't conform to the protocol <span class="lang:swift decode:true  crayon-inline ">CNContactPickerDelegate</span>. Add the following code <em>outside</em> of the <span class="lang:swift decode:true  crayon-inline ">BirthdaysListViewController</span> class:</p>
<pre class="lang:swift decode:true ">extension BirthdaysListViewController: CNContactPickerDelegate {
  func contactPicker(picker: CNContactPickerViewController, didSelectContact contact: CNContact) {
    print("name: \(contact.givenName) \(contact.familyName), birthday: \(contact.birthday)")
  }
}</pre>
<p>Build and run. In the running app tap the add button in the navigation bar and select a contact. You should see the name and birthday printed to the debug console:</p>
<pre class="lang:sh decode:true ">name: Kate Bell, birthday: Optional(&lt;NSDateComponents: 0x7b787ca0&gt;
    Calendar: &lt;_NSCopyOnWriteCalendarWrapper: 0x7b783760&gt;
    Calendar Year: 1978
    Month: 1
    Leap month: no
    Day: 20)
</pre>
<p>If the contact from the address book has the birthday set, we should create a <span class="lang:swift decode:true  crayon-inline ">Birthday</span> instance from that data. Add the following code in <span class="lang:swift decode:true  crayon-inline ">contactPicker(_:didSelectContact:)</span>:</p>
<pre class="lang:swift decode:true ">if let birthday = contact.birthday {
  let person = Birthday(firstName: contact.givenName, lastName: contact.familyName, birthday: birthday)
  print(person)
}</pre>
<p>At the moment we only print the birthday. Later we will hand that data to the data source of the table view to update the UI.</p>
<p>That's it for today. See you next time. :)</p>
